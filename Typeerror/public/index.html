<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Image Upload Example</title>
    <link rel="stylesheet" href="/public/style.css">
    <link rel="shortcut icon" href="#">
    
</head>
<body>

    <div class="container">
        <div class="image-upload" id="image-upload">

            <form method="post" enctype="multipart/form-data" >               
                <div><label class="files">FILE</label></div>
                <div class = "fileContainer">
                    <div class="fileInput">
                        <p>FILE NAME: </p>
                        <p id="fileName"></p>
                    </div>
                    <label class="input-file-button" for="input-file">Select File</label>
                    <input type="file" class="input-file-button" id="input-file" name="photo" style="visibility:hidden;" accept="image/*" onchange="loadFile(this)"/>
                    
                        
                    
                </div>
                <input type="submit" class="upload-button" id="upload-button" value="Upload" name="submit"/>                
                    
            </form> 
        <div class="image-show" id="image-show" style="background-color : #d0e3bd; width : 50%; height : 50%" ></div>
        </div>
        
        
    </div>


    <script>
        function showImage() {
            var newImage = document.getElementById('image-show').lastElementChild;
            newImage.style.visibility = "visible";

            document.getElementById('image-upload').style.visibility = 'hidden';

            document.getElementById('fileName').textContent = null;     //기존 파일 이름 지우기
        }

        function loadFile(input) {
            

            if(input){
            var file = input.files[0];	//선택된 파일 가져오기

            //미리 만들어 놓은 div에 text(파일 이름) 추가
            var name = document.getElementById('fileName');
            name.textContent = file.name;

            //새로운 이미지 div 추가
            var newImage = document.createElement("img");
            newImage.setAttribute("class", 'img');

            //이미지 source 가져오기
            newImage.src = URL.createObjectURL(file);   

            newImage.style.width = "70%";
            newImage.style.height = "70%";
            newImage.style.visibility = "hidden";   //버튼을 누르기 전까지는 이미지를 숨긴다
            newImage.style.objectFit = "contain";

            //이미지를 image-show div에 추가
            var container = document.getElementById('image-show');
            container.appendChild(newImage);
            }
        };     

        var submit = document.getElementById('upload-button');
        submit.onclick = showImage;     //Submit 버튼 클릭시 이미지 보여주기

        /*
        function readImage(input){
            //input tag에 파일이 있는 경우
            if(input.files && input.files[0]){
                //FileReader 인스턴스 생성
                const reader = new FileReader();

                reader.onload = e =>{
                    const preview = document.getElementById("image-show");
                    preview.src = e.target.result;

                }
                reader.readAsDataURL(input.files[0]);
            }
        }

        const inputImage = document.getElementById("input-file");
        inputImage.addEventListener("change", e=> {
            readImage(e.target);
        })*/

    </script>

    <script src="../app.js" charset="utf-8" defer></script>

    
</body>
</html>